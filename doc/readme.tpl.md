# Overview

A light weight set of handy functions.

Reduce the gap between working on different systems. Such as watch directory changes on a network file system, operate `spawn` on Windows and Linux, handle async IO api with promise, etc.

Rather than help you decide what to do, it is designed to create possibilities. Most times I use it as the core a build system, even this document is generated by nokit itself.

It's one of the core lib of [nobone](https://github.com/ysmood/nobone).

[![NPM version](https://badge.fury.io/js/nokit.svg)](http://badge.fury.io/js/nokit) [![Build Status](https://travis-ci.org/ysmood/nokit.svg)](https://travis-ci.org/ysmood/nokit) [![Build status](https://ci.appveyor.com/api/projects/status/3pwhk4ua9c3ojm0q?svg=true)](https://ci.appveyor.com/project/ysmood/nokit) [![Deps Up to Date](https://david-dm.org/ysmood/nokit.svg?style=flat)](https://david-dm.org/ysmood/nokit)

## Features

- Full promise sollution.
- All functions are highly lazy designed, minimum boot time.

# Installation

As a lib dependency, install it locally: `npm i nokit`.

Nokit has provaided a cli tool like GNU Make. If you install it globally like this:

`npm -g i nokit commander`

, then have fun with your `nofile`, it can be js, coffee or livescript. For more information goto the `CLI` section.

# Quick Start

## vs Gulp

```coffee
kit = require 'nokit'
drives = kit.require 'drives'

kit.warp 'src/**/*.coffee'
.load drives.coffeelint()
.load drives.coffee { bare: false }
.load drives.uglify()
.load concat 'main.js'
.run 'dist/path'

```

```coffee
# nokit extends nofs, so we don't have to require nofs here.
kit = require 'nokit'
coffee = require 'coffee-script'

# A plugin for coffee, a simple curried function.
compiler = (opts) -> ->
    @dest.ext = '.js'
    @set coffee.compile(@contents, opts)

# A plugin to prepend lisence to each file.
# Here "fileInfo.set" is the same with the "@set".
lisencer = (lisence) -> (fileInfo) ->
    @set lisence + '\n' + @contents

# A plugin to concat all files.
concat = (outputFile) ->
    all = ''

    kit._.extend ->
        all += @contents
        @end() # Disable all the followed plugins.
    , onEnd: ->
        @dest = @to + '/' + outputFile
        @set all

kit.warp 'src/**/*.coffee'
.load compiler bare: true
.load lisencer '/* MIT lisence */'
.load concat 'bundle.js'
.run 'dist'
.then ->
    kit.log 'Build Done'
```

## CLI

If you want nokit support coffee, you should install it like this:

`npm i -g nokit commander coffee-cache coffee-script`

> It's recommended to use coffee-cache, since large build project may
> consume a large portion of your nofile's startup time. Of course, it's
> optional, you may run `npm i -g nokit commander coffee-script` without
> any problem.

Same works with livescript:

`npm i -g nokit commander Livescript`

> Remarks: for the sake of boot performance, nokit will only load
> `coffee-cache coffee-script/register`
> by default. For livescript or other precompiler, you have to
> set environment varialbe `nokitPreload` to what you want, such as on unix:
> `export nokitPreload='Livescript coffee-script/register'`. Different module
> names are separated by spaces.

Create a `nofile.coffee` (or `.js`, `.ls`) at your current working directory
or any of its parents directory. The syntax of `nofile` is almost the same as the Cakefile, only the `option`'s first argument is slightly changed.

Assume your file content is:

```coffee
# There are some global variables you can call directly:
# _: lodash
# option: commander.option
# task: kit.task
# warp: kit.warp
# kit: kit
# Promise: kit.Promise

option '-w, --hello [world]', 'Just a test option', ''

# Define a default task, and it depends on the "clean" task.
task 'default', ['clean'], 'This is a comment info', (opts) ->
    kit.log opts.hello

    # "colors" is enabled by default.
    kit.log 'print red words'.red

task 'clean', ->
    kit.remove 'dist'

# To add alias to a task, just use space to separate names.
# Here 'build' and 'b' are the same task.
task 'build b', ->
    warp 'src/**/*.js'
    .load (file) ->
        file.set '/* Nothing */' + file.contents
    .run 'dist'

task 'sequential', ['clean', 'build'], true, ->
    kit.log 'Run clean and build non-concurrently.'
```

Then you can run it in command line: `no`. Just that simple, without action
argument, `no` will try to call the `default` action directly.

You can run `no -h` to display help info.

Call `no build` or `no b` to run the `build` task.

For more doc for the `option` goto [commander.js](https://github.com/tj/commander.js).

# Changelog

Goto [changelog](doc/changelog.md)

# API

<%= doc['lib/kit.coffee'] %>

# Lisence

MIT